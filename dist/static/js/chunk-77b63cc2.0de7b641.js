(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77b63cc2"],{"1c70":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"onion-add-goods"},[r("el-card",{staticClass:"box-card"},[r("el-steps",{staticStyle:{"margin-top":"20px"},attrs:{active:e.stepStatus,"finish-status":"success",simple:""}},[r("el-step",{attrs:{title:"1.编辑基本信息"},nativeOn:{click:function(t){return e.step_click(1)}}}),r("el-step",{attrs:{title:"2.编辑商品详情"},nativeOn:{click:function(t){return e.step_click(2)}}})],1),r("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("section",{directives:[{name:"show",rawName:"v-show",value:1===e.stepStatus,expression:"stepStatus === 1"}]},[r("p",[r("span",[e._v("基本信息")])]),r("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.ruleForm.suppliesName,callback:function(t){e.$set(e.ruleForm,"suppliesName",t)},expression:"ruleForm.suppliesName"}})],1),r("el-form-item",{attrs:{label:"简介"}},[r("el-input",{attrs:{placeholder:"请输入简介",type:"textarea"},model:{value:e.ruleForm.intro,callback:function(t){e.$set(e.ruleForm,"intro",t)},expression:"ruleForm.intro"}})],1),r("el-form-item",{attrs:{label:"商品缩略图"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","http-request":e.submitUpload,"show-file-list":!1,limit:1,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"商品品牌"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.brand,callback:function(t){e.$set(e.ruleForm,"brand",t)},expression:"ruleForm.brand"}},e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"商品类目"}},[r("SelectTree",{attrs:{options:e.categoryTreeData,props:e.defaultProps},model:{value:e.ruleForm.categoryId,callback:function(t){e.$set(e.ruleForm,"categoryId",t)},expression:"ruleForm.categoryId"}})],1),r("el-form-item",{attrs:{label:"商品展示图"}},[r("el-upload",{staticClass:"upload-demo",attrs:{action:"","on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.imgList,"http-request":e.submitUploadMul,"list-type":"picture"}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),r("p",[r("span",[e._v("价格库存")])]),r("el-form-item",{attrs:{label:"售价"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入售价"},model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",t)},expression:"ruleForm.price"}})],1),r("el-form-item",{attrs:{label:"库存"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入库存"},model:{value:e.ruleForm.inventory,callback:function(t){e.$set(e.ruleForm,"inventory",t)},expression:"ruleForm.inventory"}})],1),r("el-form-item",{attrs:{label:"规格"}},[r("el-input",{attrs:{placeholder:"请输入规格"},model:{value:e.ruleForm.specification,callback:function(t){e.$set(e.ruleForm,"specification",t)},expression:"ruleForm.specification"}})],1)],1),2===e.stepStatus?r("section",[r("tinymce",{ref:"editor",on:{onClick:e.onClick},model:{value:e.msg,callback:function(t){e.msg=t},expression:"msg"}})],1):e._e(),r("el-form-item",[r("el-button",{domProps:{textContent:e._s(1===e.stepStatus?"下一步":"上一步")},on:{click:e.stepTo}}),r("el-button",{directives:[{name:"show",rawName:"v-show",value:2===e.stepStatus,expression:"stepStatus === 2"}],attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")])],1)],1)],1)],1)},i=[],a=r("eaa3"),l=(r("ca72"),r("f88c")),s=r("4ec3"),n=r("bc3a"),u=r.n(n),c={components:{tinymce:l["a"],SelectTree:a["a"]},computed:{categoryTreeData:function(){return console.log(this.$store.state.categoryTreeData),this.$store.state.categoryTreeData},ruleForm:function(){return this.$store.state.goodsListRow}},data:function(){return{dialog:{dialogVisible:"false",dialogMsg:""},defaultProps:{parent:"parentId",value:"id",label:"label",children:"children"},content:"",msg:"",imgList:[],rules:{goodsName:[{required:!0,message:"请输入商品名称",trigger:"blur"}]},imageUrl:"",dialogImageUrl:"",options:[{value:"羽素",label:"羽素"},{value:"纽崔莱恩",label:"纽崔莱恩"}],stepStatus:1,flag:""}},methods:{handleRemove:function(e){},handlePreview:function(e){},onClick:function(){},submitForm:function(){var e=this;this.ruleForm.imageText=this.msg,this.ruleForm.bannerPicture=this.imageUrl,this.ruleForm.listPicture=this.imgList;var t="";this.ruleForm.price=parseInt(this.ruleForm.price),this.ruleForm.inventory=parseInt(this.ruleForm.inventory),t="add"===this.flag?"http://tadmin.yuxinhz.cn/api/product/add":"http://tadmin.yuxinhz.cn/api/product/update",u.a.post(t,this.ruleForm).then((function(t){console.log(t),e.$message({message:"add"===e.flag?"添加商品成功":"编辑商品成功",type:"success"}),e.$router.push({path:"/goodsList?pageNum="+("add"===e.flag?1:e.$route.query.pageNum)})})).catch((function(e){console.log(e)}))},resetForm:function(e){this.$refs[e].resetFields()},submitUpload:function(e){var t=new FormData;t.append("file",e.file);var r=this;Object(s["g"])(t).then((function(e){r.imageUrl=e.obj.url})).catch((function(e){console.log(e)}))},submitUploadMul:function(e){var t=new FormData;t.append("file",e.file);var r=this;Object(s["g"])(t).then((function(e){r.imgList.push(e.obj)})).catch((function(e){console.log(e)}))},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,r=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG/png 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&r},getValue:function(e){this.valueId=e,console.log(this.valueId)},step_click:function(e){this.stepStatus=e},stepTo:function(){1===this.stepStatus?this.stepStatus++:this.stepStatus--},getTreeCategory:function(){var e=this;u.a.get("http://tadmin.yuxinhz.cn/api/category/getTreeCategory",{}).then((function(t){e.$store.commit("categoryTreeData",t.data.obj.categoryList)})).catch((function(e){console.log(e)}))}},created:function(){},mounted:function(){this.flag=this.$route.query.flag}},p=c,d=(r("61d7"),r("2877")),h=Object(d["a"])(p,o,i,!1,null,null,null);t["default"]=h.exports},"61d7":function(e,t,r){"use strict";var o=r("c2c8"),i=r.n(o);i.a},"9fb6":function(e,t,r){},c2c8:function(e,t,r){},cd41:function(e,t,r){"use strict";var o=r("9fb6"),i=r.n(o);i.a},eaa3:function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-popover",{ref:"popover",attrs:{placement:"bottom-start",trigger:"click"},on:{show:e.onShowPopover,hide:e.onHidePopover}},[r("el-tree",{ref:"tree",staticClass:"select-tree",style:"min-width: "+e.treeWidth,attrs:{"highlight-current":"",data:e.data,props:e.props,"expand-on-click-node":!1,"filter-node-method":e.filterNode,"default-expand-all":!1},on:{"node-click":e.onClickNode}}),r("el-input",{ref:"input",class:{rotate:e.showStatus},style:"width: "+e.width+"px",attrs:{slot:"reference",clearable:"","suffix-icon":"el-icon-arrow-down"},slot:"reference",model:{value:e.labelModel,callback:function(t){e.labelModel=t},expression:"labelModel"}})],1)},i=[],a={name:"Pagination",props:{value:String,width:String,options:{type:Array,required:!0},props:{type:Object,required:!1,default:function(){return{parent:"parentId",value:"rowGuid",label:"areaName",children:"children"}}}},model:{prop:"value",event:"selected"},computed:{dataType:function(){var e=JSON.stringify(this.options);return-1!==e.indexOf(this.props.children)},data:function(){return this.dataType?this.options:this.switchTree()}},watch:{labelModel:function(e){e||(this.valueModel=""),this.$refs.tree.filter(e)},value:function(e){this.labelModel=this.queryTree(this.data,e)}},data:function(){return{showStatus:!1,treeWidth:"auto",labelModel:"",valueModel:"0"}},created:function(){var e=this;this.value&&(this.labelModel=this.queryTree(this.data,this.value)),this.$nextTick((function(){e.treeWidth="".concat((e.width||e.$refs.input.$refs.input.clientWidth)-24,"px")}))},methods:{onClickNode:function(e){this.labelModel=e[this.props.label],this.valueModel=e[this.props.value],this.onCloseTree()},switchTree:function(){return this.cleanChildren(this.buildTree(this.options,"0"))},onCloseTree:function(){this.$refs.popover.showPopper=!1},onShowPopover:function(){this.showStatus=!0,this.$refs.tree.filter(!1)},onHidePopover:function(){this.showStatus=!1,this.$emit("selected",this.valueModel)},filterNode:function(e,t){return!e||-1!==t[this.props.label].indexOf(e)},queryTree:function(e,t){var r=[];r=r.concat(e);while(r.length){var o=r.shift();if(o[this.props.children]&&(r=r.concat(o[this.props.children])),o[this.props.value]===t)return o[this.props.label]}return""},buildTree:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",o=function r(o){for(var i=[],a=0;a<e.length;a++){var l=e[a];l[t.props.parent]===o&&(l.children=r(l.rowGuid),i.push(l))}return i};return o(r)},cleanChildren:function(e){var t=function e(t){return t.map((function(t){return t.children.length?e(t.children):delete t.children,t})),t};return t(e)}}},l=a,s=(r("cd41"),r("2877")),n=Object(s["a"])(l,o,i,!1,null,null,null);t["a"]=n.exports}}]);